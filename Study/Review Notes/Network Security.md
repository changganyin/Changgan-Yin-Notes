## 引言
### 信息安全的基本目标
- 保密性 (Confidentiality): 确保信息不被泄露或呈现给非授权的人。
- 完整性 (Integrity): 确保数据的一致性，防止非授权生成、修改或损害数据。
- 可用性 (Availability): 确保合法用户不会无缘无故地拒绝访问信息或资源。
- 合法使用 (Legitimate Use): 确保资源不被非授权的人或以非授权的方式使用。

### 安全工具的分类（常考辨析）
1. 被动攻击 (Passive Attack)
    - 定义：试图获得系统信息，但不会对系统造成破坏。
    - 特点：难以检测（因为数据没变），但可以预防。
    - 类型：
        - 窃听 (Eavesdropping)：获取传输内容。
        - 流量分析 (Traffic Analysis)：分析通信模式（频率、长度等），即便加密也能推测信息。
2. 主动攻击 (Active Attack)
    - 定义：试图破坏系统资源，影响系统的正常工作。
    - 特点：易于检测，但难以绝对阻止（重点是检测和恢复）。
    - 类型：
        - 伪装 (Masquerade)：假冒其他实体（如 ARP 欺骗）。
        - 重放 (Replay)：截获合法数据，稍后重新发送
        - 消息篡改 (Modification)：修改、插入、删除消息。
        - 拒绝服务 (DoS)：过度使用服务，导致系统瘫痪或服务质量下降。
            - DDoS：分布式拒绝服务，利用大量“僵尸主机”同时发起攻击。

### 网络安全策略（访问控制）
*核心概念是授权 (Who may do what to what)*
1. 强制性访问控制 (MAC)
    - 由中央权威（系统）确定规则。
    - 基于安全属性，用户不能回避，主题不能干涉。
2. 自主性访问控制 (DAC)
    - 基于主体的标识或所属的组。
    - 权限可以穿点，用户可以利用权限控制对资源的进一步访问。

### P2DR2 安全模型
*这是一个动态的安全循环模型*
1. Policy: 核心，在安全工程中起主导地位。
2. Protection: 安全的第一步（如防火墙、补丁）。
3. Detection: 发现异常或攻击模型。
4. Response: 报告、记录、反应（阻止入侵）。
5. Restore: 清除影响，恢复系统。

### OSI 安全体系结构 (X.800) -- 必考表格
5 类服务和 8 种机制，重点在于对应关系
1. 五类安全服务
    1. 鉴别 (Authentication)：对等实体认证、数据源认证。
    2. 访问控制 (Access Control)。
    3. 数据保密性 (Confidentiality)。
    4. 数据完整性 (Integrity)。 
    5. 不可否认性 (Non-repudiation)：防抵赖。
2. 关键对应关系
    - 加密机制：保密性、鉴别、数据完整性
    - 数字签名机制：不可否认性、鉴别、数据完整性
    - 流量填充机制：流量保密性
    - 路由控制机制：保密性
    - 公证机制：不可否认行、数据完整性

## Internet 协议的安全性
### 数据链路层 (Data Link Layer, L2)
关注对象：MAC 地址、局域网帧
- 核心协议：ARP (地址解析协议)
    - 漏洞原理：ARP 是无状态的，且缺乏验证机制。主机收到 ARP 应答时，会无条件信任并更新缓存，不验证是否发送过请求。
- 主要攻击：
    - ARP 欺骗 (ARP Spoofing)：
        - 攻击者发送伪造的 ARP 应答包，将网关的 IP 地址映射到攻击者自己的 MAC 地址。
        - 后果：流量被截获（中间人攻击 MITM）或断网（拒绝服务）。
    - 网络嗅探 (Sniffing)：利用网卡混杂模式接收局域网内所有数据。

### 网络层 (Network Layer, L3)
关注对象：IP 地址、数据包路由
- 主要攻击 (利用协议缺陷)：
    - IP 欺骗 (IP Spoofing)：伪造数据包的源 IP 地址，用于隐藏身份或绕过基于 IP 的认证。
    - 分片攻击 (Teardrop)：构造重叠的 IP 分片，利用操作系统重组分片的漏洞导致系统崩溃。
    - ICMP 攻击：
        - Smurf 攻击：伪造受害者 IP 向广播地址发送 ICMP Echo Request，导致网络风暴。
        - ICMP 重定向：攻击者冒充路由器改变受害者的路由表。
- 防御措施 (安全协议)：IPSec (IP Security)
    - 定位：在 IP 层提供保护，对上层应用透明。
    - 两大组件 (考试常考辨析)：
        - AH (鉴别首部)：提供完整性、源认证。不加密 (数据可见)。
        - ESP (封装安全载荷)：提供保密性 (加密)、完整性、源认证。
    - 两种模式：
        - 传输模式 (Transport)：保护 IP 载荷 (上层数据)，不改变原 IP 头。用于主机到主机。
        - 隧道模式 (Tunnel)：保护 整个 IP 包，生成新 IP 头。用于 VPN (网关到网关)。

### 传输层 (Transport Layer, L4)
关注对象：端口、连接状态 (TCP)、端到端通信
- 主要攻击：
    - SYN Flood (拒绝服务)：
        - 原理：利用 TCP 三次握手缺陷。发送大量 SYN 包但不回复 ACK，占满服务器的半连接队列。
        - 后果：正常用户无法建立连接。
    - TCP 会话劫持：预测 TCP 序列号 (Sequence Number)，接管已建立的连接。
    - 端口扫描：TCP Connect (全连接)、TCP SYN (半隐蔽)、TCP FIN (秘密)。
- 防御措施 (安全协议)：SSL/TLS (安全套接字层)
    - 定位：介于传输层与应用层之间 (通常归于传输层安全)。
    - 功能：为 TCP 连接提供保密性、完整性和身份认证。
    - 组成：
        - 握手协议 (上层)：协商加密算法、交换密钥、验证证书。
        - 记录协议 (底层)：分片、压缩、加密数据。
### 应用层 (Application Layer, L7)
关注对象：具体应用程序的数据、用户身份
- 防御措施 (安全协议)：
    - SSH (Secure Shell)：
        - 替代 Telnet/FTP。
        - 提供加密的远程登录和文件传输，防止密码在网络中明文传输。
    - PGP (Pretty Good Privacy)：
        - 用于电子邮件安全。
        - 提供邮件的加密 (保密性) 和数字签名 (完整性/抗抵赖)。
        - 信任模型：Web of Trust (信任网)，不同于 SSL 的层级 CA 信任。

## 网络扫描与监控
### 网络扫描 (Network Scanning)
目的：在攻击前收集目标信息，包括：存活主机 IP、开放端口（服务）、操作系统类型、系统弱点。
1. 主机发现 (Host Discovery)
    确定目标网络中哪些主机是“活”的。
    - 常用方法：
        - ICMP Echo 扫描 (Ping 扫描)：向目标发送 `Echo Request`，如果收到 `Echo Reply`，说明主机存活。
            - _缺点_：很多防火墙会过滤 ping 包，导致漏报。
        - Broadcast ICMP (广播扫描)：向广播地址发包，探测网段内所有主机。
2. 端口扫描 (Port Scanning) -- 考试重点
    确定目标主机开放了哪些服务（如 Web 服务通常在 80 端口）。
    - TCP 扫描的基础：三次握手与标志位
        - 概念解释：
            - SYN (Synchronize)：同步位，用于发起连接。
            - ACK (Acknowledgment)：确认位，确认收到数据。
            - FIN (Finish)：结束位，用于关闭连接。
            - RST (Reset)：复位位，强制断开连接（通常表示端口关闭或拒绝）。
    - 扫描类型对比

| 扫描类型   | 原理                                      | 优点            | 缺点                              |
| ------ | --------------------------------------- | ------------- | ------------------------------- |
| 全连接扫描  | 完整的 TCP 三次握手                            | 稳定，无需高权限      | 速度慢，容易被日志记录 (不隐蔽)               |
| 半连接扫描  | 发送 SYN，收到 SYN/ACK 后，回复 RST 中断连接，不完成握手   | 隐蔽（不记日志），速度快  | 需要系统高权限 (构造原始包)                 |
| 秘密扫描   | 发送 **FIN** 包。若端口关闭则回 RST；若端口开放则忽略 (不回复) | 极其隐蔽，能绕过部分防火墙 | 依赖系统实现 (Windows 无论开关都回 RST，故无效) |
| UDP 扫描 | 发送 UDP 包。若回 ICMP "端口不可达" 则关闭；无响应 则可能开放  | 针对 UDP 服务     | 慢，不可靠 (容易被防火墙丢包导致误判)            |
3. 操作系统检测 (OS Detection)
    - 栈指纹检测 (Stack Fingerprinting)：不同操作系统的 TCP/IP 协议栈实现细节（如 TTL 值、窗口大小、对错误包的响应）存在微小差异。通过发送特定探测包并分析响应，可以推断 OS 类型。
### 网络监听 (Network Sniffing)
定义：在网络中捕获并分析数据包，通常称为“抓包”。
1. 监听原理
    - 核心概念：网卡混杂模式 (Promiscuous Mode)
        - 概念解释：正常情况下，网卡只会接收发给自己（MAC 地址匹配）或广播的数据包，忽略其他包。开启混杂模式后，网卡会接收流经它的**所有**数据包，无论目的地是否是自己。
        - 监听工具（如 Wireshark/Sniffer）工作时必须开启此模式。
2. 监听环境：共享式 vs. 交换式 (常考)
    - 共享网络 (Shared Ethernet) —— 使用 Hub (集线器)
        - 环境特点：Hub 是物理层设备，它会把收到的信号广播转发给所有端口。
        - 监听方法：攻击者只需将网卡设为混杂模式，即可听到局域网内所有流量。
        - 防御：无法防监听，只能靠加密。
    - 交换网络 (Switched Ethernet) —— 使用 Switch (交换机)
        - 环境特点：Switch 是数据链路层设备，它维护一张 MAC 地址表，只把数据包转发给目标 MAC 对应的端口，实现了隔离。
        - 监听难点：普通情况下，A 发给 B 的包，C 所在的端口根本收不到。
        - 破解方法：ARP 欺骗 (ARP Spoofing)。
3. 监听的检测与防范
    - 检测：
        - Ping 测试：发送 IP 正确但 MAC 错误的 Ping 包。正常机器不回，处于混杂模式的机器可能会回。
        - ARP 监控：检测网络中是否有非法的 ARP 广播。
    - 防范：
        - 物理隔离：使用交换机代替集线器（虽然不能完全防住 ARP 欺骗，但增加了难度。
        - 加密通信 (最有效)：使用 SSH 代替 Telnet，使用 HTTPS 代替 HTTP。即使被监听，数据也是乱码。
        - 静态 ARP 表：手动绑定 IP 和 MAC，防止被欺骗。

## 防火墙技术
### 基础概念 (Basic Concepts)
1. 什么是防火墙？
    - 定义：置于不同网络安全域（如企业内网与互联网）之间的一系列部件的组合。
    - 核心功能：
        - 访问控制：是“传达室大爷”，检查进出的人（数据包）。
        - 日志记录：记录谁来过，干了什么。
        - 地址转换 (NAT)：隐藏内部网络结构。
    - 局限性 (常考简答)：
        - 防外不防内：无法防止内部员工的恶意攻击。
        - 无法防备绕过防火墙的连接（如私自拨号上网）。
        - 无法完全防范病毒（因为防火墙通常不扫描文件内容，只看包头）。
2. 安全策略 (Security Policies)
    - 默认允许 (Default Permit)：“凡是没有被禁止的，都是允许的”。
        - 特点：方便，但**不安全**。
    - 默认拒绝 (Default Deny)：“凡是没有被允许的，都是禁止的”。
        - 特点：安全，但配置麻烦，可能会误伤正常业务。
        - _考试提示：企业安全通常采用默认拒绝策略。_

### 防火墙技术分类 (Firewall Technologies) —— 核心考点
这部分需要重点区分三种技术的工作层次和优缺点。
1. 包过滤技术 (Packet Filtering) —— "静态检查"
    - 工作层次：网络层 (Network Layer)。
    - 原理：根据数据包的头部信息（源/目的 IP、源/目的端口、协议类型 TCP/UDP）来决定放行还是丢弃。就像看门大爷只看你的身份证和介绍信，不问你具体进去干嘛。
    - 优点：速度快，对用户透明，成本低。
    - 缺点：
        - 无状态：无法识别这是个新连接还是回应包，容易被欺骗。
        - 规则复杂，容易配置错误。
        - 不能解析应用层数据（看不懂 HTTP 内容）。
2. 应用代理技术 (Application Proxy) —— "中间人"
    - 工作层次：应用层 (Application Layer)。
    - 原理：客户端不直接连服务器，而是连代理。代理拆开数据包，检查应用层内容（如 HTTP 请求是否合法），再由代理去连服务器。就像大爷把你拦下来，把你的信拆开读一遍，没问题再帮你送进去。
    - 优点：安全性高，能进行内容过滤（如禁止访问特定网页），有详细日志。
    - 缺点：速度慢（要拆包重组），需要针对每种服务（FTP, HTTP）开发专门的代理软件，兼容性差。
3. 状态检测技术 (Stateful Inspection) —— "动态包过滤"
    - 工作层次：主要在网络层，但结合了会话状态。
    - 原理：不仅看包头，还维护一张状态表 (State Table)，记录连接的上下文（如“这个 ACK 包是不是对应刚才那个 SYN 包的回复”）。
    - 概念解释：
        - 有状态 (Stateful)：系统有“记忆”，知道当前数据包属于哪个正在进行的对话。
    - 优点：综合了包过滤的速度和接近代理的安全性。
    - 缺点：对协议状态跟踪复杂，可能面临 DoS 攻击（状态表被填满）。

### 防火墙体系结构 (Architectures)
屏蔽子网体系结构 (Screened Subnet) —— 即 DMZ
这是最安全的结构，也是考试最喜欢考图的。
- 核心概念：DMZ (Demilitarized Zone, 非军事化区)
    - 解释：在内部网络（非常安全）和外部网络（非常危险）之间，建立一个缓冲区。
    - 放置规则：
        - 公用服务器（Web, Mail, DNS）放在 DMZ 区。即使这些服务器被黑，黑客也只能进 DMZ，进不了核心内网。
        - 核心数据（数据库、员工 PC）放在 内部网络。
- 结构组成：通常包含两个路由器（外部路由器、内部路由器）和一个堡垒主机。
    - 堡垒主机 (Bastion Host)：DMZ 中暴露给外网的最关键主机，必须经过严格加固（Hardened）。

### NAT 技术 (Network Address Translation)
- 概念解释：
    - NAT：将内部的私有 IP 地址（如 192.168.x.x）转换为互联网上的公有 IP 地址。
    - 作用：解决 IPv4 地址不足问题 ，同时隐藏内部网络结构。
- 三种类型：
    1. 静态 NAT：一对一，固定映射（用于内部服务器对外提供服务）。
    2. 动态 NAT：多对多，从地址池中取。
    3. PAT (端口复用/NAPT)：多对一。所有内网员工共用一个公网 IP 上网，通过端口号区分。
- 源 NAT (SNAT) vs 目的 NAT (DNAT)：
    - SNAT：员工上网用。修改源地址（把内网 IP 换成公网 IP）。
    - DNAT：发布服务器用。修改目的地址（外部访问公网 IP，防火墙转发给内网真实服务器）。

## 入侵检测技术
### 基础概念 (Basics)
1. 什么是 IDS？
    - 定义：入侵检测系统 (Intrusion Detection System)。它是 P2DR 模型中 Detection (检测) 环节的核心。
    - 作用：防火墙无法阻挡所有攻击（特别是来自内部的攻击或绕过防火墙的攻击），IDS 的作用是实时监控网络或主机活动，发现违规行为并报警。
    - 形象比喻：
        - 防火墙 = 门禁/防盗门（不让进）。
        - IDS = 监控摄像头+警报器（进来了能发现）。
2. 两个核心指标 (常考辨析)
    在评价 IDS 好坏时，有两个容易混淆的指标：
    - 漏报 (False Negative)："狼来了没报"。
        - 解释：明明是攻击，IDS 却认为是正常行为，放过了它。这是最危险的。
    - 误报 (False Positive)："狼没来瞎报"。
        - 解释：明明是正常操作，IDS 却认为是攻击并报警。误报太多会导致管理员麻痹（“狼来了”的故事）。

### IDS 的分类 (Classification)
根据“它安装在哪里”，可以分为两类：
1. 基于网络的 IDS (NIDS)
    - 位置：部署在网段中（通常旁路接入）。
    - 原理：网卡开启混杂模式，监听流经该网段的所有数据包。
    - 优点：一台设备能监控整个网段，隐蔽性好（不需配置 IP），很难被攻击者发现。
    - 缺点：无法分析加密流量（如 HTTPS），处理高速网络时容易丢包。
2. 基于主机的 IDS (HIDS)
    - 位置：安装在具体的服务器或 PC 上（作为软件 agent）。
    - 原理：监控这台机器的系统日志、文件完整性（核心文件是否被篡改）、进程行为。
    - 优点：能检测加密流量（因为在主机上解密后才处理），能确定攻击是否成功（看系统文件变没变）。
    - 缺点：占用主机资源（CPU/内存），如果主机被攻陷，HIDS 可能也会失效。

### 检测技术 (Detection Methodologies) —— 绝对核心考点
这是本章最重要的部分，必须区分“误用检测”和“异常检测”。
1. 误用检测 (Misuse Detection) —— 又称“特征检测”
    - 通俗解释："黑名单法"。警察手里有一本通缉犯相册（攻击特征库），看到长得像通缉犯的就抓。
    - 原理：将收集到的数据与预先定义的攻击特征库 (Signature) 进行匹配。
    - 优点：
        - 准确率高：对于已知的攻击，一抓一个准。
        - 误报率低。
    - 缺点：
        - 无法检测未知攻击 (0-day)：如果攻击者是“新面孔”（特征库里没有），就无法识别。
        - 需要频繁更新特征库。
2. 异常检测 (Anomaly Detection) —— 又称“行为检测”
    - 通俗解释："白名单法/基线法"。警察不知道坏人长啥样，但知道好人通常干什么。比如你平时都朝九晚五，突然凌晨3点在公司疯狂拷贝文件，这就叫“异常”。
    - 原理：先建立一个正常行为的轮廓 (Profile)，如果当前行为偏离了正常轮廓（超过阈值），就认为是攻击。
    - 优点：
        - 能发现未知攻击：不管你用什么新花样，只要你的行为反常，就能抓到。
    - 缺点：
        - 误报率高：正常用户的行为稍微变一下（比如偶尔加班），也可能被当成攻击。

| 对比维度 | 误用检测 (Misuse)      | 异常检测 (Anomaly)   |
| ---- | ------------------ | ---------------- |
| 依据   | 已知攻击特征 (Signature) | 正常行为轮廓 (Profile) |
| 逻辑   | “不像坏人就是好人”         | “不像好人就是坏人”       |
| 未知攻击 | 无法检测 ❌             | 可以检测 ✅           |
| 主要缺点 | 漏报（新攻击）            | 误报（正常变动）         |
|      |                    |                  |

### 典型工具：Snort
- 定义：一款开源的、轻量级的 NIDS (基于网络的入侵检测系统)。
- Snort 规则结构 (考题可能会给一条规则让你解释)：
    - 格式：`[动作] [协议] [源IP] [源端口] -> [目的IP] [目的端口] (选项)`
    - 例子：`alert tcp any any -> 192.168.1.0/24 80 (msg:"Web Attack";)`
    - 解释：如果检测到从任何地址发往 192.168.1.0 网段 80 端口的 TCP 包，就报警并记录消息 "Web Attack"。

### 蜜罐技术 (Honeypot)
- 概念：一种欺骗技术。故意设置一个存在漏洞的、虚假的系统，诱骗攻击者对其进行攻击。
- 目的：
    1. 保护真实系统：把火力引开。
    2. 收集证据：详细记录攻击者的操作，分析其攻击手段（因为正常用户绝对不会去访问蜜罐，所以进入蜜罐的一定是攻击者）。

## VPN 技术
### 基础概念 (VPN Overview)
1. 什么是 VPN？
    - 定义：虚拟专用网 (Virtual Private Network)。
    - 核心思想：利用公用网络（如 Internet）的设施，构建专用的、安全的数据通信通道。
    - 特点：
        - 虚拟 (Virtual)：没有铺设物理专线，是逻辑上的连接。
        - 专用 (Private)：通过加密和认证，像专线一样安全。
2. 核心技术：隧道技术 (Tunneling) —— 新概念必读
    这是 VPN 的地基。如果不理解隧道，就无法理解 VPN。
    - 通俗解释：
        - 想象你要寄一封信 (原始数据包)，但这封信的内容不能被邮递员看到，且格式不符合邮局要求。
        - 于是，你拿了一个更大的信封 (隧道协议头)，把原来的信整个装进去，并在大信封上写上新的收件地址（VPN 网关地址）。
        - 邮局（Internet）只看大信封，负责把它送到目的地。目的地收到后，拆开大信封，取出里面的信。
    - 专业定义：一种通过互联网络基础设施在网络之间传递数据的方式。利用一种网络协议（如 IP）来封装另一种网络协议（如 IP, IPX, AppleTalk）。
    - 过程：封装 (Encapsulation) -> 传输 -> 解封装 (Decapsulation)。

### VPN 的分类 (Classification)
1. 按应用场景分类 (常考选择/填空)
    1. Access VPN (远程接入 VPN)：
        - 场景：出差员工/SOHO 办公 -> 公司内网。
        - 特点：客户端需要拨号或安装软件（或用浏览器）。
    2. Intranet VPN (内网 VPN)：
        - 场景：总公司 -> 分公司 (Site-to-Site)。
        - 作用：替代传统的长途专线，连接两个局域网。
    3. Extranet VPN (外网 VPN)：
        - 场景：公司 -> 合作伙伴/供应商。
        - 作用：授权外部人员访问公司特定资源。
2. 按协议层级分类
    - 第二层 (数据链路层) VPN：PPTP, L2TP（多用于早期的拨号接入）。
    - 第三层 (网络层) VPN：IPSec, GRE。
    - 第四层/应用层 VPN：SSL/TLS VPN。

### 主流 VPN 技术详解 (重点)
1. IPSec VPN (回顾与应用)
    我们在第2章学过 IPSec 协议，这里讲它作为 VPN 的应用。
    - 工作层级：网络层 (Layer 3)。
    - 模式：通常使用 隧道模式 (Tunnel Mode)。
    - 典型场景：网关到网关 (Site-to-Site)。例如：北京总部的路由器连上海分部的路由器。
    - 优点：
        - 透明性：对上层应用透明，所有应用（Web, FTP, 邮件, ERP）都能直接用，不需要单独改配置。
        - 安全性极高。
    - 缺点：
        - 配置复杂：两端设备必须严格匹配参数。
        - 难以穿越 NAT：需要 NAT-T 技术支持。
        - 客户端麻烦：如果是个人接入，电脑上必须装专门的客户端软件。
2. SSL VPN (TLS VPN)
    - 工作层级：应用层/会话层。
    - 核心：利用浏览器自带的 SSL/TLS 协议（即 HTTPS）。
    - 典型场景：移动办公/远程接入 (Client-to-Site)。例如：员工在咖啡厅用笔记本访问公司 OA 系统。
    - 优点：
        - 无客户端 (Clientless)：不需要安装额外软件，有浏览器就行。
        - 穿透性好：使用的是 443 端口，几乎所有防火墙都默认放行。
        - 细粒度控制：可以精确限制用户只能访问某个网页，而不是整个内网。
    - 缺点：
        - 性能：略低于 IPSec（应用层封装开销）。
        - 应用受限：主要针对 Web 应用（B/S 架构）。如果要访问非 Web 应用（如远程桌面），通常需要下载插件。

### IPSec VPN vs. SSL VPN (考试必考对比表)
复习时请重点看这个表，开卷考试时遇到“该选哪种 VPN”的题目直接查表。

| 对比维度   | IPSec VPN                                      | SSL VPN                                        |
| ------ | ---------------------------------------------- | ---------------------------------------------- |
| 工作层次   | 网络层 (L3)                                       | 应用层/会话层 (L4-L7)                                |
| 典型场景   | 网点互联 (Site-to-Site)<br><br>  <br><br>(连接两个局域网) | 移动接入 (Remote Access)<br><br>  <br><br>(连接单个用户) |
| 客户端软件  | 需要安装 (配置繁琐)                                    | 不需要 (使用浏览器)                                    |
| 访问范围   | 全网接入 (一旦连上，等于接入了整个内网)                          | 特定应用 (通常只能访问 Web 资源)                           |
| 易用性    | 差 (对用户要求高)                                     | 好 (即插即用)                                       |
| NAT 穿越 | 困难 (需 NAT-T)                                   | 容易 (标准 HTTPS)                                  |

### 补充知识点
- GRE (Generic Routing Encapsulation)：
    
    - 定义：通用路由封装协议。
        
    - 特点：它是一种隧道协议，能包装各种乱七八糟的协议（IPX, AppleTalk），也支持组播（IPSec 不支持组播）。
        
    - 缺陷：GRE 不加密，没有安全性。
        
    - 组合拳：通常把 GRE + IPSec 结合使用。GRE 负责打包运货（兼容性好），IPSec 负责给车上锁（安全性好）。

## 身份认证
### 基础概念
1. 认证与授权的区别
    - 识别 (Identification)：声称自己是谁（如输入用户名）。
    - 认证 (Authentication)：证明自己确实是所声称的那个人（如输入密码）。
    - 授权 (Authorization)：确定这个人能做什么（如管理员权限）。
    - 认证是安全的第一道防线。
2. 身份认证的三大要素 (实现途径)
    通常通过以下一种或组合来实现：
    1. 所知 (What you know)：你掌握的知识，如口令 (Password)、PIN 码。
    2. 所有 (What you have)：你拥有的东西，如身份证、智能卡 (Smart Card)、USB Key。
    3. 个人特征 (Who you are)：你的生物特征，如指纹、虹膜、人脸。

### 口令认证系统 (Password)
这是最常用的认证方式。
1. 安全风险
- 弱口令：容易被猜测（如生日、单词）。
- 泄露：明文传输被窃听、服务器存储的文件被窃取。
- 重放攻击：攻击者截获旧的口令数据包重新发送。
1. 保护措施
- 限制尝试次数：防止暴力破解。
- 密码加盐 (Salt) 存储：
    - UNIX 系统的做法：用户输入密码 + 12bit 盐值 (时间) -> 经过 25 次 DES 迭代运算 -> 存储。
    - 目的：防止通过“彩虹表”或字典批量破解相同的密码。

### 一次性口令认证 (OTP)
为了解决静态口令容易被窃听和重放的问题，OTP 确保每次认证使用的口令都不同。
1. 挑战/响应机制 (Challenge/Response)
- 流程：
    1. 用户发起请求。
    2. 服务器发送一个随机数（挑战值）。
    3. 用户利用手中的令牌（或私钥）对挑战值进行运算，返回结果（响应值）。
    4. 服务器进行同样的计算并比对。
- 优点：安全性高，无同步问题。
- 缺点：交互次数多，用户操作可能繁琐。
2. 口令序列机制 (S/Key)
- 原理 (Lamport 哈希链)：
    - 利用单向函数 f (如 MD5/SHA) 进行迭代计算。
    - 生成顺序：从 x 开始，计算 f(x), f(f(x))... 直到第 n 次，得到 F1, F2... Fn。
    - 使用顺序：倒序使用。先用 Fn，下次用 Fn-1，依此类推。
    - 验证：服务器保存当前的 Fn。用户提交 Fn-1，服务器计算 f(Fn-1)，如果等于 Fn，则验证通过，并将 Fn-1 存为新的基准。
- 优点：服务器不需要存储用户的原始密钥，只存哈希值，相对安全。
1. 时间同步机制
- 原理：令牌和服务器都基于当前时间（如每分钟变一次）和共享密钥生成口令。
- 优点：用户无需输入挑战值，操作方便。
- 缺点：非常依赖时钟同步，如果令牌时钟漂移（走快/走慢），会导致认证失败。
1. 事件同步机制 (计数器)
- 原理：以“按键次数”作为变量。每按一次，计数器加 1，生成新口令。
- 解决不同步：如果用户误触了令牌导致计数器超前，服务器通常会设置一个“窗口值”（如允许向后多试 3-10 个），在这个范围内都算通过并自动同步。

### 生物特征身份认证
基于“你是谁”进行认证。
1. 分类
- 生理特征 (先天)：指纹、视网膜、虹膜、掌纹、人脸。
- 行为特征 (后天习惯)：笔迹 (签名)、步态、语音。
1. 常见技术对比
- 指纹识别：
    - 优点：方便、便宜、技术成熟。
    - 缺点：指纹可能磨损、易残留指纹被复制。
- 虹膜/视网膜识别：
    - 优点：精度极高（误识率最低），难以伪造。
    - 缺点：设备昂贵，用户体验较差（需要眼睛对准设备）。
- 人脸识别：
    - 优点：非接触，友好。
    - 缺点：受光线、姿态影响，双胞胎或整容可能造成误判。
1. 评价指标
- 误识率 (FAR)：把坏人当好人放进去了（安全隐患）。
- 拒识率 (FRR)：把好人当坏人拦在外面了（影响体验）。
- 两个指标通常是此消彼长的，需要权衡。

### 基于证书的认证 (PKI)
这是基于公钥密码体制 (非对称加密) 的强认证方式。
1. 流程
    1. 注册：用户向 CA (证书机构) 申请数字证书，证书中包含用户的公钥和个人信息。        
    2. 登录：
        - 用户发送登录请求。
        - 服务器发送随机挑战值。
        - 用户用自己的私钥对挑战值进行数字签名，发回给服务器。
        - 服务器向 CA 检索或在本地查找用户的公钥 (证书)。
        - 服务器用公钥验证签名。如果解密出的挑战值与发出的一致，则认证成功。
    3. 优点：私钥永不传输，不怕窃听；具有抗抵赖性。

### 智能卡技术 (Smart Card)

1. 与磁条卡的区别
- 磁条卡 (ID 卡)：仅仅是存储数据（类似录音带），容易被复制（盗刷）。
- 智能卡 (IC 卡)：内置 CPU、RAM、ROM，是一台微型计算机。
    - 数据有分区保护（公开区、秘密区）。
    - 可以进行加密运算，数据难以被读出复制。
2. 应用
- SIM 卡、二代身份证、银行芯片卡、U 盾 (USB Key) 都是智能卡的应用形式。
- USB Key 是一种带有 USB 接口的智能卡，常用于存储数字证书和私钥。

## 考前 30 分钟速通
### 攻击类型 (第1讲)
- 只要没有修改数据，就是被动攻击。被动攻击只有窃听和流量分析
- 只要修改了数据或发了假数据，就是主动攻击 (伪装、重放、篡改、DoS)。
- 被动攻击重在预防 (加密)，主动攻击重在检测 (因为防不住)。

### 机制与服务的对应 (第1讲)
- 看到 抗抵赖/不可否认性，找 数字签名 或 公证。
- 看到 流量保密性 (防流量分析)，找 流量填充。

### TCP/IP 协议漏洞 (第2讲)
- ARP 欺骗利用了 ARP 协议无状态、无验证的缺陷 (收到就信)。
- SYN Flood 利用了 TCP 三次握手的半连接队列 (耗尽资源)。
- Smurf 攻击利用了 ICMP 广播响应 (借刀杀人)。
- Teardrop 利用了 IP 分片重组漏洞。

### IPSec 的两个模式与两个协议 (第2讲)
- AH (鉴别首部)：只签名，不加密 (能防篡改，但防不了窃听)。
- ESP (封装安全载荷)：既签名，又加密 (防篡改 + 防窃听)。
- 传输模式：两台主机直接聊，不隐藏 IP 头 (头部: IP | IPSec | Data)。
- 隧道模式：网关对网关 (VPN)，生成新 IP 头，隐藏原 IP (头部: New IP | IPSec | Old IP | Data)。

### 扫描技术的隐蔽性 (第3讲)
- TCP Connect (全连接)：最吵，最准，容易被发现。
- TCP SYN (半连接)：发 SYN，收 SYN/ACK，回 RST。不建立连接，较隐蔽。
- TCP FIN (秘密)：发 FIN，如果没反应就是开着，如果回 RST 就是关着 (Windows 无效)。

### 防火墙谁最安全 (第4讲)
- 包过滤：只看门牌号 (IP/端口)，快但不安全。
- 应用代理：拆信检查内容，最安全但最慢。
- 状态检测：记住谁先开的口 (状态表)，又快又安全。
- DMZ 区：放 Web、邮件服务器的地方 (牺牲品区)，核心数据别放这。

### 入侵检测的误报与漏报 (第5讲)

- 误用检测 (特征库)：像抓通缉犯。准，但防不了新攻击 (漏报)。
    
- 异常检测 (行为基线)：像抓行为怪异的人。能防新攻击，但容易冤枉好人 (误报)。

### VPN 选型 (第6讲)
- 两个分公司互联 (Site-to-Site)：用 IPSec VPN (网络层，透明)。
- 员工出差/在家办公 (Client-to-Site)：用 SSL VPN (应用层，无客户端，浏览器即可)。

### 身份认证的细节 (第7讲)
- 认证 (Authentication) 是证明你是谁；授权 (Authorization) 是你能干什么。
- 加盐 (Salt) 是为了防彩虹表/字典攻击，不是为了防窃听。
- S/Key 的关键是倒序使用哈希值。
- 生物识别中，指纹最方便，视网膜/虹膜最准 (但贵)。

## 去年真题
### 一、单选题（每题 2 分，共 20 分）

1. 以下哪种攻击方式主要是通过发送大量的请求来耗尽目标系统的资源，使其无法正常服务？（B）
    A. 缓冲区溢出攻击
    B. 拒绝服务攻击（DoS）
    C. 中间人攻击
    D. SQL 注入攻击

2. 下列哪个是对称加密算法？（C）
    A. RSA
    B. ECC
    C. AES
    D. DSA
    解析：
    - 常见对称加密：DES, 3DES, AES, RC4, IDEA。
    - 常见非对称加密：RSA, ECC, ElGamal。

3. 数字签名的主要目的是（B）
    A. 保证信息的机密性
    B. 保证信息的完整性和不可否认性
    C. 保证信息的可用性
    D. 保证信息的真实性

4. 防火墙工作在网络层时，主要基于（A）进行数据包的过滤。
    A. IP 地址和端口号
    B. 应用层协议
    C. 数据内容
    D. MAC 地址
    解析：
    包过滤防火墙通常工作在网络层和传输层，根据 **源/目的IP地址** 和 **源/目的端口号** 进行过滤。

5. 以下哪个不属于常见的网络安全漏洞？（C）
    A. 弱口令
    B. 系统补丁未及时更新
    C. 防火墙开启
    D. SQL 注入点

6. 入侵检测系统（IDS）的主要功能是（B）
    A. 阻止所有网络攻击
    B. 检测并响应网络中的异常活动
    C. 加密网络数据
    D. 管理网络设备

7. 下列关于 VPN 的说法，错误的是（C）
    A. VPN 可以提供安全的远程访问
    B. VPN 可以隐藏用户的真实 IP 地址
    C. VPN 只能在企业内部网络使用
    D. VPN 通过加密隧道传输数据

8. 哈希函数的主要作用是（B）
    A. 加密数据
    B. 生成数据的唯一标识
    C. 解密数据
    D. 压缩数据

9. 以下哪种协议用于在网络中进行身份认证和授权？（C）
    A. HTTP
    B. FTP
    C. LDAP
    D. SMTP
    解析：
    - **A. HTTP / B. FTP / D. SMTP：** 分别是网页、文件和邮件的传输协议。
    - **C. LDAP (轻量级目录访问协议)：** 常用于统一身份认证、账号管理和目录服务。

10. 安全审计的主要目的是（B）
    A. 发现系统漏洞
    B. 记录和分析系统活动，以检测安全事件
    C. 加密系统数据
    D. 提高系统性能

### 二、多选题（每题 3 分，共 15 分）

1. 常见的网络安全威胁包括（ABCD）
    A. 病毒
    B. 木马
    C. 蠕虫
    D. 间谍软件

2. 以下属于网络安全防护技术的有（ABCD）
    A. 防火墙
    B. 入侵检测系统
    C. 加密技术
    D. 访问控制

3. 数字证书包含的信息有（ABCD）
    A. 证书持有者的公钥
    B. 证书颁发机构的签名
    C. 证书持有者的身份信息
    D. 证书的有效期

4. 以下哪些措施可以提高无线网络的安全性？（ABCD）
    A. 使用 WPA2 或 WPA3 加密
    B. 隐藏 SSID
    C. 定期更改密码
    D. 关闭无线广播
    解析：
    SSID (Service Set Identifier)：服务集标识符，就是**无线网络的名称**

5. 网络安全的基本要素包括（ABC）
    A. 机密性
    B. 完整性
    C. 可用性
    D. 可控性
    解析：
    网络安全三个基本要素：
    - Confidentiality: 机密性
    - Integrity: 完整性
    - Availability: 可用性
    拓展要素：
    - Non-repudiation: 不可否认性
    - Controllability: 可控性
    - Auditability: 可审查性
    - Authenticity: 真实性

### 三、判断题（每题 1 分，共 10 分）
1. 只要安装了杀毒软件，计算机就不会受到任何病毒的攻击。（×）
2. 对称加密算法的加密和解密使用相同的密钥。（√）
3. 防火墙可以完全阻止网络中的所有攻击。（×）
4. 弱口令不会对系统安全造成威胁。（×）
5. 入侵检测系统可以实时阻止所有入侵行为。（×）
6. 哈希函数的输出长度是固定的。（√）
7. 数字签名可以保证信息的机密性。（×）
8. VPN 可以绕过网络限制，因此在任何情况下都可以使用。（×）
9. 安全审计只是一种形式，对网络安全没有实际作用。（×）
10. 网络安全是一个动态的过程，需要持续的维护和管理。（√）

### 四、填空题（每题 2 分，共 20 分）
1. 网络安全中，常见的认证方式有口令认证、*证书*认证和生物特征认证。
2. 防火墙的主要类型有包过滤防火墙、*应用代理*防火墙和状态检测防火墙。
3. 常见的加密算法分为对称加密算法和*非对称*加密算法。
4. 入侵检测系统分为基于*误用*的入侵检测系统和基于异常的入侵检测系统。
5. 数字证书的颁发机构通常称为*CA (Certificate Authority)*。
6. 网络安全中的“三要素”是机密性、完整性和*可用性*。
7. 哈希函数的特性包括*敏感性*、抗碰撞性和单向性。
    解析：哈希特性通常包括：单向性、抗碰撞性、以及输入微小变化导致输出巨大变化的敏感性（雪崩效应）。也可填“定长性”或“计算可行性”，视教材而定，但敏感性是核心安全特征。
8. 常见的网络攻击类型有拒绝服务攻击、*指数*攻击和中间人攻击等。
    解析：口令窃取、欺骗攻击、软件缺陷、认证失效、拒绝服务攻击、指数攻击、信息泄露、协议缺陷。
9. VPN 的全称是*Virtual Private Network*。
10. 安全审计的主要内容包括系统日志审计、*数据库*审计和网络流量审计。

### 五、综合应用题（共 35 分）
1. （10 分）某公司网络遭受了一次拒绝服务攻击（DoS），导致公司网站无法正常访问。请分析可能的攻击原因，并提出相应的防范措施。
    攻击原因：
    - 攻击者利用僵尸网络发送海量数据包（如 TCP SYN Flood, UDP Flood, HTTP Get Flood），导致服务器 CPU/内存耗尽或网络带宽堵塞。
    - 协议漏洞：利用 TCP 三次握手等协议设计的缺陷（如 SYN Flood 半连接）。
    防范措施：
    - 在防火墙或路由器上开启抗 DDoS 功能，限制半连接数和单 IP 速率。
    - 部署专业的流量清洗设备或使用运营商/云厂商的 DDoS 高防服务（CDN），将恶意流量引流并过滤。
    - 优化操作系统 TCP/IP 栈参数（如缩短超时时间），及时修补系统漏洞。
    - 采用负载均衡技术，增加服务器带宽和处理能力，避免单点故障。

2. （12 分）设计一个简单的网络安全方案，用于保护一个小型企业的内部网络。要求包括网络拓扑结构、安全设备的部署和安全策略的制定。
    网络拓扑结构：
    - **边界区：** 使用 **防火墙** 连接互联网和内网。
    - **DMZ 区（非军事化区）：** 放置对外服务的 Web 服务器、邮件服务器。DMZ 与内网隔离，防止外网攻陷服务器后直通内网。
    - **核心内网区：** 员工 PC、内部数据库、文件服务器。
    安全设备部署：
    - **边界防火墙：** 配置 ACL（访问控制列表），仅开放必要端口。
    - **入侵检测/防御系统 (IDS/IPS)：** 旁路或串联部署在核心交换机处，监控内部流量。
    - **终端安全：** 所有 PC 安装企业版杀毒软件，并统一管理补丁更新。
    安全策略：
    - **最小权限原则：** 用户仅拥有完成工作所需的最小网络访问权限。
    - **强认证策略：** 强制 90 天更改密码，密码需包含大小写字母及数字。
    - **备份与恢复：** 关键数据每日增量备份，每周全量备份，并异地存放。

3. （13 分）已知一个对称加密算法使用的密钥为“abc123”，明文为“Hello, World!”，请简要描述该对称加密算法的加密和解密过程，并说明如何保证密钥的安全性。
    - 加密和解密过程：
        1. 密钥预处理：- 发送方和接收方必须预先共享并通过安全渠道持有同一个密钥 "abc123"。
        2. 加密过程：
            - 算法将明文 "Hello, World!" 分组（例如按 64bit 或 128bit 分块）。
            - 算法利用密钥 "abc123" 对明文数据进行复杂的数学运算（如**置换**、**代换**、**异或**等）。
            - 经过多轮运算后，生成乱码状的**密文**。
        3. 解密过程：
            - 接收方收到密文。
            - 使用相同的密钥 "abc123"，运行加密算法的**逆运算**。
            - 将密文还原为原始明文 "Hello, World!"。
    - 保证密钥安全性：
        - 绝不能通过明文邮件或聊天工具直接发送密钥。应使用带外方式（如面对面、电话）或通过非对称加密（如 RSA）交换对称密钥（即混合加密机制）。
        - 密钥不应硬编码在代码中，应存储在专用的硬件安全模块 (HSM) 或加密的密钥库中。
        - 定期更换密钥（密钥轮换），一旦怀疑泄露立即废除。
        - 实际应用中 "abc123" 是弱密钥，应使用足够长度（如 AES-256）和高熵值的随机字符串。

4. 预测题：非对称加密算法原理（综合应用题）：已知 Alice 和 Bob 使用非对称加密算法（如 RSA）进行通信。请简要描述：
    - Alice 如何向 Bob 发送一条**机密**消息？
    - Alice 如何向 Bob 发送一条消息，并证明该消息确实是她发送的（**数字签名**）？
    - 如何保证非对称加密体系的安全性？
    解析：
    1. 基础概念：密钥对
        在非对称加密中，每个用户都拥有一对密钥：
        - **公钥 (Public Key, $PK$)**：公开给所有人，用于**加密**数据或**验证**签名。
        - **私钥 (Private Key, $SK$)**：由用户自己严密保管，绝不示人，用于**解密**数据或**生成**签名。
    2. 场景一：发送机密消息（加密与解密过程）
        目标：Alice 想给 Bob 发送 "Hello"，只有 Bob 能看懂。
        - 加密过程（使用接收方的公钥）：
            1. **获取公钥：** Alice 获取 Bob 的**公钥 ($PK_{Bob}$)**。
            2. **运算：** Alice 使用 $PK_{Bob}$ 对明文 "Hello" 进行加密运算。
            3. **发送：** 生成密文，发送给 Bob。
            4. **原理：** 此时，即使 Alice 自己也无法解开这条密文，只有拥有对应私钥的人才能解开。
        - 解密过程（使用接收方的私钥）：
            1. **接收：** Bob 收到密文。
            2. **运算：** Bob 使用自己的**私钥 ($SK_{Bob}$)** 进行解密逆运算。
            3. **还原：** 密文还原为明文 "Hello"。
    3. 场景二：数字签名（认证与完整性）
        目标：Bob 收到消息，需要确认是 Alice 发的，且没被篡改。
        - 签名过程（使用发送方的私钥）：
            1. **生成摘要：** Alice 对明文进行哈希运算（如 SHA-256），生成摘要。
            2. **加密摘要：** Alice 使用自己的**私钥 ($SK_{Alice}$)** 对摘要进行加密。这个加密后的摘要就是“数字签名”。
            3. **发送：** Alice 将“明文 + 数字签名”一起发给 Bob。
        - 验签过程（使用发送方的公钥）：
            1. **解密签名：** Bob 使用 Alice 的**公钥 ($PK_{Alice}$)** 解密数字签名，得到“摘要 A”。
            2. **计算摘要：** Bob 对收到的明文进行同样的哈希运算，得到“摘要 B”。
            3. **对比：** 如果 摘要 A = 摘要 B，证明消息未被篡改，且确实是 Alice 发的。
    4. 如何保证安全性
        1. 私钥保护（最关键）：
            - 私钥必须由所有者在本地安全存储（如使用 USB Key、硬件加密机 HSM），严禁在网络上传输私钥。
            - 如果私钥丢失，必须立即吊销证书（CRL）。
        2. 公钥的信任链（防中间人攻击）：
            - **问题：** 如果黑客冒充 Bob，把假公钥给了 Alice，Alice 就会把秘密发给黑客。
            - **解决：** 必须引入权威的第三方机构 **CA (证书授权中心)**。
            - CA 用自己的私钥对 Bob 的公钥进行签名，生成**数字证书**。Alice 验证证书合法后，才能信任这个公钥属于 Bob。
        3. 密钥长度与算法强度：
            - 非对称加密的计算复杂度远高于对称加密，因此需要更长的密钥来抵抗破解。
            - 例如：RSA 算法通常要求 **2048位** 或以上才安全；ECC（椭圆曲线）通常要求 **256位**。

|**特性**|**对称加密 (AES, DES)**|**非对称加密 (RSA, ECC)**|
|---|---|---|
|**密钥数量**|1个（双方共享同一个）|2个（公钥公开，私钥保密）|
|**计算速度**|极快（适合大数据流）|慢（比对称慢1000倍以上）|
|**主要用途**|加密大量文件、数据库|身份认证、数字签名、交换对称密钥|
|**安全性挑战**|密钥分发困难（怎么把密钥给对方？）|中间人攻击（公钥是否可信？）|
